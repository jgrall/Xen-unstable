Index: ioemu/vl.c
===================================================================
--- ioemu.orig/vl.c	2006-07-12 11:35:01.687705323 +0100
+++ ioemu/vl.c	2006-07-12 11:35:01.753697055 +0100
@@ -159,6 +159,8 @@
 #define MAX_CPUS 1
 #endif
 
+extern int vcpus;
+
 int xc_handle;
 
 char domain_name[1024] = { 'H','V', 'M', 'X', 'E', 'N', '-'};
@@ -4635,6 +4637,7 @@
            "-m megs         set virtual RAM size to megs MB [default=%d]\n"
            "-smp n          set the number of CPUs to 'n' [default=1]\n"
            "-nographic      disable graphical output and redirect serial I/Os to console\n"
+           "-vcpus          set CPU number of guest platform\n"
 #ifndef _WIN32
 	   "-k language     use keyboard layout (for example \"fr\" for French)\n"
 #endif
@@ -4809,6 +4812,7 @@
     QEMU_OPTION_vnc,
 
     QEMU_OPTION_d,
+    QEMU_OPTION_vcpus,
 };
 
 typedef struct QEMUOption {
@@ -4886,6 +4890,7 @@
     { "cirrusvga", 0, QEMU_OPTION_cirrusvga },
     
     { "d", HAS_ARG, QEMU_OPTION_d },
+    { "vcpus", 1, QEMU_OPTION_vcpus },
     { NULL },
 };
 
@@ -5508,6 +5513,10 @@
                 domid = atoi(optarg);
                 fprintf(logfile, "domid: %d\n", domid);
                 break;
+            case QEMU_OPTION_vcpus:
+                vcpus = atoi(optarg);
+                fprintf(logfile, "qemu: the number of cpus is %d\n", vcpus);
+                break;
             }
         }
     }
