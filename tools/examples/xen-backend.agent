#! /bin/sh

#ACTION=add
#DEVPATH=/devices/xen-backend/vif-1-0
#PHYSDEVDRIVER=vif
#XENBUS_TYPE=vif

PATH=/etc/xen/scripts:$PATH

case "$ACTION" in
  add)
    case "$XENBUS_TYPE" in
      vbd)
	/etc/xen/scripts/block bind
        ;;
    esac
    ;;
  remove)
    case "$XENBUS_TYPE" in
      vbd)
	/etc/xen/scripts/block unbind
        ;;
    esac
    # remove device backend store entries
    xenstore-rm -t "$XENBUS_PATH"
    ;;
  online)
    case "$PHYSDEVDRIVER" in
      vif)
        [ -n "$script" ] && $script up
        ;;
    esac
    ;;
  offline)
    ;;
esac

