--- 0002/kernel/sys.c
+++ work/kernel/sys.c
@@ -435,8 +435,12 @@ void kernel_kexec(void)
 	kernel_restart_prepare(NULL);
 	printk(KERN_EMERG "Starting new kernel\n");
 	machine_shutdown();
+#ifdef CONFIG_XEN
+	xen_machine_kexec(image);
+#else
 	machine_kexec(image);
 #endif
+#endif
 }
 EXPORT_SYMBOL_GPL(kernel_kexec);
 
